import{_ as e,p as a,d as o,r as t,a as l,c as s,b as r,J as n,K as i,l as d,j as m}from"./vendor.18b10b7e.js";import{r as g}from"./index.01945ecf.js";const c={setup(){},data:()=>({rules:{name:[{required:!0,message:"账号不能为空",trigger:"blur"}],pwd:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:5,max:16,message:"密码长度为5-16位",trigger:"blur"}]},loginFormState:{name:"",pwd:"",loading:!1}}),methods:{handleLogin(){window.sessionStorage.setItem("cid",this.loginFormState.name),this.loginFormState.loading=!0;let a={username:this.loginFormState.name,password:this.loginFormState.pwd};this.$axios.post("/user/login",a).then((a=>{let{data:o,msg:t,success:l,code:s}=a.data;if(console.log(a.data),!0===l){this.$store.dispatch("setToken",o),sessionStorage.setItem("state",JSON.stringify(Object.assign({},this.$store.state))),this.loginFormState.loading=!1;let a="/"+o.auth;console.log(a),e.success("登陆成功"+t),setTimeout((()=>{g.replace({path:a})}),1e3)}else e.error("登陆失败(then)"+t+" Code:"+s),this.loginFormState.loading=!1})).catch((a=>{e.error("登录失败"+a),this.loginFormState.loading=!1})),g.replace("/merchant")}}},u=d();a("data-v-26cedb9e");const p={class:"login"},h=r("div",{class:"card_header"},[r("span",null,"用户登录")],-1),f=m("登 录");o();const S=u(((e,a,o,d,m,g)=>{const c=t("el-input"),S=t("el-form-item"),F=t("el-button"),b=t("el-form"),w=t("el-card");return l(),s("div",p,[r(w,{class:"login_center"},{header:u((()=>[h])),default:u((()=>[r(b,{model:m.loginFormState,rules:m.rules,ref:"loginFormRef"},{default:u((()=>[r(S,{prop:"name"},{default:u((()=>[r(c,{"prefix-icon":"el-icon-user-solid",modelValue:m.loginFormState.name,"onUpdate:modelValue":a[1]||(a[1]=e=>m.loginFormState.name=e),modelModifiers:{trim:!0},maxlength:"32",placeholder:"请输入账号",clearable:""},null,8,["modelValue"])])),_:1}),r(S,{prop:"pwd"},{default:u((()=>[r(c,{"prefix-icon":"el-icon-lock",modelValue:m.loginFormState.pwd,"onUpdate:modelValue":a[2]||(a[2]=e=>m.loginFormState.pwd=e),modelModifiers:{trim:!0},maxlength:"16","show-password":"",placeholder:"请输入密码",clearable:"",onKeyup:n(i(g.handleLogin,["exact"]),["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),r(S,null,{default:u((()=>[r(F,{type:"primary",style:{width:"100%"},loading:m.loginFormState.loading,onClick:g.handleLogin},{default:u((()=>[f])),_:1},8,["loading","onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])}));c.render=S,c.__scopeId="data-v-26cedb9e";export{c as default};
